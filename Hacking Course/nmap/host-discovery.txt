ğŸ¯ Lesson â€” Host Discovery (How Nmap Finds â€œWho Is Aliveâ€)

Before scanning ports, Nmap first asks:

ğŸ‘‰ â€œOut of all these IPs, which ones are actually ON?â€

Because:

scanning millions of dead IPs = ğŸ˜´ slow + useless

finding only alive devices = âš¡ fast + smart

This stage is also called:

Ping Scan

Host Discovery

Letâ€™s understand cleanly.

ğŸŸ¢ 1ï¸âƒ£ What happens by DEFAULT?

If you donâ€™t give any special discovery options, Nmap automatically sends:

ICMP Echo (like normal ping)

TCP SYN to port 443

TCP ACK to port 80

ICMP timestamp

Meaning:
ğŸ‘‰ If a device replies to ANY of these â†’ it is alive ğŸ‘

On local network:

Nmap uses ARP scan

Because ARP is 100% accurate locally and faster

So default is already smart.

ğŸ§ª 2ï¸âƒ£ Different Levels of Host Discovery

There are 3 main styles:

âœ”ï¸ A) List Scan (Only List, Send Nothing)

Command:

nmap -sL <target>


This:

âŒ sends NO packets

âœ… just prints list of targets + DNS names

Good for:

checking if your target list is correct

verifying domains

planning scan

But:
âŒ Does NOT tell who is alive

âœ”ï¸ B) Ping Scan (Find Alive Hosts â€” No Port Scan)

Command:

nmap -sn <target>


This is SUPER IMPORTANT.
It:

âœ”ï¸ finds alive machines

âŒ does NOT scan ports

Useful for:

network inventory

counting active devices

light, quiet recon

This is what most admins use.

Default probes in -sn:

ICMP Echo

TCP SYN 443

TCP ACK 80

ICMP timestamp

ARP on local network

ğŸ‘‰ If blocked by firewall, you can customize probes (coming below)

âœ”ï¸ C) No Ping (Assume EVERY Host Is Alive)

Command:

nmap -Pn <target>


Meaning:

Skip host discovery completely

Treat every IP as alive

Go straight to heavy scanning

Useful when:

firewall blocks ping

you KNOW targets are alive

internet targets hide ping response

âš ï¸ Downside:

SLOW

scans even dead hosts

Bonus:

nmap -Pn -sn


Skips everything but still runs scripts if needed.

ğŸ”¥ 3ï¸âƒ£ Powerful Custom Discovery Options (-P*)

When firewall blocks default ping, we use smarter probes.

1ï¸âƒ£ TCP SYN Ping
nmap -PS80,443 <target>


Sends SYN packets.
If RST or SYN/ACK returns â†’ host alive.

Great when:

ICMP blocked

SYN allowed

2ï¸âƒ£ TCP ACK Ping
nmap -PA80,443 <target>


Bypasses some firewalls that block SYN but allow ACK.

Tip:
ğŸ‘‰ Many pentesters send BOTH

nmap -PS -PA <target>

3ï¸âƒ£ UDP Ping
nmap -PU <target>


Useful when:

TCP firewalled

UDP responses more likely

Normally slower.

4ï¸âƒ£ ICMP Ping Types

Normal ping:

nmap -PE <target>


Timestamp ping:

nmap -PP <target>


Address mask ping:

nmap -PM <target>


Great for:

internal networks

admin monitoring

But internet targets often block ICMP.
5ï¸âƒ£ SCTP Ping (rare)
nmap -PY <target>


Used in telecom systems mostly.

6ï¸âƒ£ IP Protocol Ping
nmap -PO <target>


Advanced, rarely needed.
Can detect devices even when normal ping fails.