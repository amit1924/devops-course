ğŸ¯ Lesson â€” What Exactly Is Running on That Port?

Earlier Nmap told you:

22/tcp open   ssh
80/tcp open   http
53/udp open   domain


Cool.
But as a security learner, you need MORE:

Which SSH? OpenSSH? Dropbear?

Which HTTP server? Apache? Nginx? Version?

Which DNS? BIND? Microsoft DNS?

Because:
ğŸ‘‰ Version = Vulnerability clarity
If you know version â†’ you know whatâ€™s weak / outdated.

Thatâ€™s what version detection does.

ğŸ§  What Nmap Actually Does

After discovering open ports,
Nmap sends smart probes to those ports and watches how they respond.

It detects:
âœ”ï¸ Protocol (HTTP? SSH? FTP?)
âœ”ï¸ Application (Apache? OpenSSH?)
âœ”ï¸ Version number
âœ”ï¸ OS family
âœ”ï¸ Device type
âœ”ï¸ Hostname
âœ”ï¸ CPE (standard vulnerability format)

Sometimes even cool things like:

SSH key info

SSL certificate info

Printer brand

Router model ğŸ˜

ğŸ› ï¸ Command to Enable Version Detection
â­ Most Important:
nmap -sV <target>


or

ğŸ”¥ Power Mode
nmap -A <target>


(A also includes OS detection + scripts + traceroute)

ğŸ§© What Happens Internally?

Nmap uses:
ğŸ“‚ nmap-service-probes database
which contains thousands of probes like:

special HTTP requests

SSH hello messages

DNS queries

SSL/TLS greetings

It compares responses to its huge fingerprint database (~6500+ matches)

If something is new:
ğŸ‘‰ Nmap prints UNKNOWN fingerprint
ğŸ‘‰ Gives URL to submit
ğŸ‘‰ Community grows the database ğŸ˜

ğŸ§¬ Bonus Superpower

Sometimes a UDP port appears:

open|filtered


Meaning Nmap canâ€™t tell.

Version detection tries again with smarter probes and if it gets a reply:
âœ”ï¸ It changes to OPEN

Same for TCP too.

ğŸ·ï¸ RPC Detection (Automatic!)

If Nmap finds RPC services:
ğŸ‘‰ It automatically runs RPC grinder
(which is like rpcinfo -p even behind firewall!)

You donâ€™t need to do anything extra âœŒï¸

âš™ï¸ Version Detection Options (Simple & Practical)
1ï¸âƒ£ Enable Version Scan
-sV


Alias:

-sR


(both same now)

2ï¸âƒ£ Scan ALL PORTS including risky ones

By default, Nmap skips printer port 9100
because many printers would literally PRINT your scan output ğŸ˜†

To force scanning everything:

--allports

3ï¸âƒ£ Control Scan Aggressiveness

Intensity scale:
0 = super light
9 = try EVERYTHING

Default = 7

Light mode (fast)
--version-light


(same as intensity 2)

Full hardcore scan
--version-all


(same as intensity 9)

4ï¸âƒ£ Debugging Version Scan

Want to see exactly what Nmap is doing?

--version-trace


This shows:

every probe sent

every response received

matching logic

Great for learning ğŸ‘

â¤ï¸ Ethical Reminder

Use version scanning:
âœ”ï¸ On your own devices
âœ”ï¸ in labs
âœ”ï¸ on systems you have permission for

Because version scanning is more â€œtouchyâ€ than simple port scan.

Youâ€™re learning ethical hacking and thatâ€™s awesome ğŸ˜Š